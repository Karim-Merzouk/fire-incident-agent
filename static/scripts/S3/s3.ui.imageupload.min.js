/*
 jQuery Color Animations v2.0pre
 http://jquery.org/

 Copyright 2011 John Resig
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(e,R){function K(b,q,k){var h=S[q.type]||{};if((q.empty||k)&&null==b)return null;if(q.def&&null==b)return q.def;b=h.floor?~~b:parseFloat(b);return null==b||isNaN(b)?q.def:h.mod?(b%=h.mod,0>b?h.mod+b:b):h.min>b?h.min:h.max<b?h.max:b}function F(b){var q=r(),k=q._rgba=[];b=b.toLowerCase();T(u,function(h,B){h=(h=B.re.exec(b))&&B.parse(h);var E=B.space||"rgba";B=C[E].cache;if(h)return h=q[E](h),q[B]=h[B],k=q._rgba=h._rgba,!1});if(0!==k.length)return 0===Math.max.apply(Math,k)&&e.extend(k,ha.transparent),
q;if(b=ha[b])return b}function g(b,q,k){k=(k+1)%1;return 1>6*k?b+6*(q-b)*k:1>2*k?q:2>3*k?b+(q-b)*(2/3-k)*6:b}var c=/^([\-+])=\s*(\d+\.?\d*)/,u=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(b){return[b[1],b[2],b[3],b[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(b){return[2.55*b[1],2.55*b[2],2.55*b[3],b[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,
parse:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(b){return[b[1],b[2]/100,b[3]/100,b[4]]}}],r=e.Color=function(b,q,k,h){return new e.Color.fn.parse(b,q,k,h)},C={rgba:{cache:"_rgba",props:{red:{idx:0,
type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},S={"byte":{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},Y=C.rgba.props,O=r.support={},T=e.each;C.hsla.props.alpha=Y.alpha;r.fn=r.prototype={constructor:r,parse:function(b,q,k,h){if(b===R)return this._rgba=
[null,null,null,null],this;if(b instanceof e||b.nodeType)b=b instanceof e?b.css(q):e(b).css(q),q=R;var B=this,E=e.type(b),I=this._rgba=[];q!==R&&(b=[b,q,k,h],E="array");if("string"===E)return this.parse(F(b)||ha._default);if("array"===E)return T(Y,function(N,z){I[z.idx]=K(b[z.idx],z)}),this;if("object"===E)return b instanceof r?T(C,function(N,z){b[z.cache]&&(B[z.cache]=b[z.cache].slice())}):T(C,function(N,z){T(z.props,function(G,a){var U=z.cache;if(!B[U]&&z.to){if(null==b[G]||"alpha"===G)return;B[U]=
z.to(B._rgba)}B[U][a.idx]=K(b[G],a,!0)})}),this},is:function(b){var q=r(b),k=!0,h=this;T(C,function(B,E){var I=q[E.cache];if(I){var N=h[E.cache]||E.to&&E.to(h._rgba)||[];T(E.props,function(z,G){if(null!=I[G.idx])return k=I[G.idx]===N[G.idx]})}return k});return k},_space:function(){var b=[],q=this;T(C,function(k,h){q[h.cache]&&b.push(k)});return b.pop()},transition:function(b,q){var k=r(b);b=k._space();var h=C[b],B=this[h.cache]||h.to(this._rgba),E=B.slice();k=k[h.cache];T(h.props,function(I,N){I=
N.idx;var z=B[I],G=k[I],a=S[N.type]||{};null!==G&&(null===z?E[I]=G:(a.mod&&(G-z>a.mod/2?z+=a.mod:z-G>a.mod/2&&(z-=a.mod)),E[N.idx]=K((G-z)*q+z,N)))});return this[b](E)},blend:function(b){if(1===this._rgba[3])return this;var q=this._rgba.slice(),k=q.pop(),h=r(b)._rgba;return r(e.map(q,function(B,E){return(1-k)*h[E]+k*B}))},toRgbaString:function(){var b="rgba(",q=e.map(this._rgba,function(k,h){return null==k?2<h?1:0:k});1===q[3]&&(q.pop(),b="rgb(");return b+q.join(",")+")"},toHslaString:function(){var b=
"hsla(",q=e.map(this.hsla(),function(k,h){null==k&&(k=2<h?1:0);h&&3>h&&(k=Math.round(100*k)+"%");return k});1===q[3]&&(q.pop(),b="hsl(");return b+q.join(",")+")"},toHexString:function(b){var q=this._rgba.slice(),k=q.pop();b&&q.push(~~(255*k));return"#"+e.map(q,function(h,B){h=(h||0).toString(16);return 1===h.length?"0"+h:h}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}};r.fn.parse.prototype=r.fn;C.hsla.to=function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,
null,null,b[3]];var q=b[0]/255,k=b[1]/255,h=b[2]/255;b=b[3];var B=Math.max(q,k,h),E=Math.min(q,k,h),I=B-E,N=B+E,z=.5*N;return[Math.round(E===B?0:q===B?60*(k-h)/I+360:k===B?60*(h-q)/I+120:60*(q-k)/I+240)%360,0===z||1===z?z:.5>=z?I/N:I/(2-N),z,null==b?1:b]};C.hsla.from=function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,null,null,b[3]];var q=b[0]/360,k=b[1],h=b[2];b=b[3];k=.5>=h?h*(1+k):h+k-h*k;h=2*h-k;return[Math.round(255*g(h,k,q+1/3)),Math.round(255*g(h,k,q)),Math.round(255*g(h,k,q-1/3)),
b]};T(C,function(b,q){var k=q.props,h=q.cache,B=q.to,E=q.from;r.fn[b]=function(I){B&&!this[h]&&(this[h]=B(this._rgba));if(I===R)return this[h].slice();var N=e.type(I),z="array"===N||"object"===N?I:arguments,G=this[h].slice();T(k,function(U,da){U=z["object"===N?U:da.idx];null==U&&(U=G[da.idx]);G[da.idx]=K(U,da)});if(E){var a=r(E(G));a[h]=G;return a}return r(G)};T(k,function(I,N){r.fn[I]||(r.fn[I]=function(z){var G=e.type(z),a="alpha"===I?this._hsla?"hsla":"rgba":b,U=this[a](),da=U[N.idx];if("undefined"===
G)return da;"function"===G&&(z=z.call(this,da),G=e.type(z));if(null==z&&N.empty)return this;"string"===G&&(G=c.exec(z))&&(z=da+parseFloat(G[2])*("+"===G[1]?1:-1));U[N.idx]=z;return this[a](U)})})});T("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),function(b,q){e.cssHooks[q]={set:function(k,h){var B;if("string"!==e.type(h)||(B=F(h))){h=r(B||h);if(!O.rgba&&1!==h._rgba[3]){var E="backgroundColor"===q?k.parentNode:k;do B=e.curCSS(E,"backgroundColor");
while((""===B||"transparent"===B)&&(E=E.parentNode)&&E.style);h=h.blend(B&&"transparent"!==B?B:"_default")}h=h.toRgbaString()}k.style[q]=h}};e.fx.step[q]=function(k){k.colorInit||(k.start=r(k.elem,q),k.end=r(k.end),k.colorInit=!0);e.cssHooks[q].set(k.elem,k.start.transition(k.end,k.pos))}});e(function(){var b=document.createElement("div").style;b.cssText="background-color:rgba(1,1,1,.5)";O.rgba=-1<b.backgroundColor.indexOf("rgba")});var ha=e.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",
black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",
lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);
(function(e){e.Jcrop=function(R,K){function F(d){return Math.round(d)+"px"}function g(d){d=e(d).offset();return[d.left,d.top]}function c(d){return[d.pageX-oa[0],d.pageY-oa[1]]}function u(d){"object"!==typeof d&&(d={});a=e.extend(a,d);e.each(["onChange","onSelect","onRelease","onDblClick"],function(w,t){"function"!==typeof a[t]&&(a[t]=function(){})})}function r(d,w,t){oa=g(J);ia.setCursor("move"===d?d:d+"-resize");if("move"===d)return ia.activateHandlers(S(w),b,t);w=L.getFixed();var A=Y(d),l=L.getCorner(Y(A));
L.setPressed(L.getCorner(A));L.setCurrent(l);ia.activateHandlers(C(d,w),b,t)}function C(d,w){return function(t){if(a.aspectRatio)switch(d){case "e":t[1]=w.y+1;break;case "w":t[1]=w.y+1;break;case "n":t[0]=w.x+1;break;case "s":t[0]=w.x+1}else switch(d){case "e":t[1]=w.y2;break;case "w":t[1]=w.y2;break;case "n":t[0]=w.x2;break;case "s":t[0]=w.x2}L.setCurrent(t);D.update()}}function S(d){var w=d;za.watchKeys();return function(t){L.moveOffset([t[0]-w[0],t[1]-w[1]]);w=t;D.update()}}function Y(d){switch(d){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function O(d){return function(w){if(a.disabled||"move"===d&&!a.allowMove)return!1;oa=g(J);pa=!0;r(d,c(w));w.stopPropagation();w.preventDefault();return!1}}function T(d,w,t){var A=d.width(),l=d.height();A>w&&0<w&&(A=w,l=w/d.width()*d.height());l>t&&0<t&&(l=t,A=t/d.height()*d.width());Z=d.width()/A;ba=d.height()/l;d.width(A).height(l)}function ha(d){return{x:d.x*
Z,y:d.y*ba,x2:d.x2*Z,y2:d.y2*ba,w:d.w*Z,h:d.h*ba}}function b(d){d=L.getFixed();d.w>a.minSelect[0]&&d.h>a.minSelect[1]?(D.enableHandles(),D.done()):D.release();ia.setCursor(a.allowSelect?"crosshair":"default")}function q(d){if(a.disabled||!a.allowSelect)return!1;pa=!0;oa=g(J);D.disableHandles();ia.setCursor("crosshair");var w=c(d);L.setPressed(w);D.update();ia.activateHandlers(k,b,"touch"===d.type.substring(0,5));za.watchKeys();d.stopPropagation();d.preventDefault();return!1}function k(d){L.setCurrent(d);
D.update()}function h(){var d=e("<div></div>").addClass(a.baseClass+"-tracker");da&&d.css({opacity:0,backgroundColor:"white"});return d}function B(d){E([d[0]/Z,d[1]/ba,d[2]/Z,d[3]/ba]);a.onSelect.call(ea,ha(L.getFixed()));D.enableHandles()}function E(d){L.setPressed([d[0],d[1]]);L.setCurrent([d[2],d[3]]);D.update()}function I(){a.disabled=!0;D.disableHandles();D.setCursor("default");ia.setCursor("default")}function N(){a.disabled=!1;G()}function z(d,w,t){w=w||a.bgColor;a.bgFade&&e.fx.step.hasOwnProperty("backgroundColor")&&
a.fadeTime&&!t?d.animate({backgroundColor:w},{queue:!1,duration:a.fadeTime}):d.css("backgroundColor",w)}function G(d){a.allowResize?d?D.enableOnly():D.enableHandles():D.disableHandles();ia.setCursor(a.allowSelect?"crosshair":"default");D.setCursor(a.allowMove?"move":"default");a.hasOwnProperty("trueSize")&&(Z=a.trueSize[0]/M,ba=a.trueSize[1]/H);a.hasOwnProperty("setSelect")&&(B(a.setSelect),D.done(),delete a.setSelect);la.refresh();a.bgColor!=Ca&&(z(a.shade?la.getShades():ja,a.shade?a.shadeColor||
a.bgColor:a.bgColor),Ca=a.bgColor);ta!=a.bgOpacity&&(ta=a.bgOpacity,a.shade?la.refresh():D.setBgOpacity(ta));ua=a.maxSize[0]||0;va=a.maxSize[1]||0;wa=a.minSize[0]||0;xa=a.minSize[1]||0;a.hasOwnProperty("outerImage")&&(J.attr("src",a.outerImage),delete a.outerImage);D.refresh()}var a=e.extend({},e.Jcrop.defaults),U=navigator.userAgent.toLowerCase(),da=/msie/.test(U),Da=/msie [1-6]\./.test(U);"object"!==typeof R&&(R=e(R)[0]);"object"!==typeof K&&(K={});u(K);K={border:"none",visibility:"visible",margin:0,
padding:0,position:"absolute",top:0,left:0};var V=e(R);U=!0;if("IMG"==R.tagName){if(0!=V[0].width&&0!=V[0].height)V.width(V[0].width),V.height(V[0].height);else{var Aa=new Image;Aa.src=V[0].src;V.width(Aa.width);V.height(Aa.height)}var J=V.clone().removeAttr("id").css(K).show();J.width(V.width());J.height(V.height());V.after(J).hide()}else J=V.css(K).show(),U=!1,null===a.shade&&(a.shade=!0);T(J,a.boxWidth,a.boxHeight);var M=J.width(),H=J.height(),ja=e("<div />").width(M).height(H).addClass(a.baseClass+
"-holder").css({position:"relative",backgroundColor:a.bgColor}).insertAfter(V).append(J);a.addClass&&ja.addClass(a.addClass);var ma=e("<div />"),ya=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),qa=e("<div />").width("100%").height("100%").css("zIndex",320),ra=e("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var d=L.getFixed();a.onDblClick.call(ea,d)}).insertBefore(J).append(ya,qa);U&&(ma=e("<img />").attr("src",J.attr("src")).css(K).width(M).height(H),
ya.append(ma));Da&&ra.css({overflowY:"hidden"});var sa=a.boundary,na=h().width(M+2*sa).height(H+2*sa).css({position:"absolute",top:F(-sa),left:F(-sa),zIndex:290}).mousedown(q),Ca=a.bgColor,ta=a.bgOpacity,ua,va,wa,xa,Z,ba,pa,Ba,Ea;var oa=g(J);var fa=function(){function d(){var t={},A=["touchstart","touchmove","touchend"],l=document.createElement("div"),n;try{for(n=0;n<A.length;n++){var y=A[n];y="on"+y;var v=y in l;v||(l.setAttribute(y,"return;"),v="function"==typeof l[y]);t[A[n]]=v}return t.touchstart&&
t.touchend&&t.touchmove}catch(aa){return!1}}var w=!0===a.touchSupport||!1===a.touchSupport?a.touchSupport:d();return{createDragger:function(t){return function(A){if(a.disabled||"move"===t&&!a.allowMove)return!1;oa=g(J);pa=!0;r(t,c(fa.cfilter(A)),!0);A.stopPropagation();A.preventDefault();return!1}},newSelection:function(t){return q(fa.cfilter(t))},cfilter:function(t){t.pageX=t.originalEvent.changedTouches[0].pageX;t.pageY=t.originalEvent.changedTouches[0].pageY;return t},isSupported:d,support:w}}(),
L=function(){function d(){if(!a.aspectRatio){var f=y-l,x=v-n;ua&&Math.abs(f)>ua&&(y=0<f?l+ua:l-ua);va&&Math.abs(x)>va&&(v=0<x?n+va:n-va);xa/ba&&Math.abs(x)<xa/ba&&(v=0<x?n+xa/ba:n-xa/ba);wa/Z&&Math.abs(f)<wa/Z&&(y=0<f?l+wa/Z:l-wa/Z);0>l&&(y-=l,l-=l);0>n&&(v-=n,n-=n);0>y&&(l-=y,y-=y);0>v&&(n-=v,v-=v);y>M&&(f=y-M,l-=f,y-=f);v>H&&(f=v-H,n-=f,v-=f);l>M&&(f=l-H,v-=f,n-=f);n>H&&(f=n-H,v-=f,n-=f);return A(t(l,n,y,v))}f=a.aspectRatio;x=a.minSize[0]/Z;var Q=a.maxSize[0]/Z,P=y-l,ca=v-n,p=Math.abs(P),m=Math.abs(ca);
0===Q&&(Q=10*M);p/m<f?(p=v,m*=f,m=0>P?l-m:m+l,0>m?(m=0,p=Math.abs((m-l)/f),p=0>ca?n-p:p+n):m>M&&(m=M,p=Math.abs((m-l)/f),p=0>ca?n-p:p+n)):(m=y,p/=f,p=0>ca?n-p:n+p,0>p?(p=0,m=Math.abs((p-n)*f),m=0>P?l-m:m+l):p>H&&(p=H,m=Math.abs(p-n)*f,m=0>P?l-m:m+l));m>l?(m-l<x?m=l+x:m-l>Q&&(m=l+Q),p=p>n?n+(m-l)/f:n-(m-l)/f):m<l&&(l-m<x?m=l-x:l-m>Q&&(m=l-Q),p=p>n?n+(l-m)/f:n-(l-m)/f);0>m?(l-=m,m=0):m>M&&(l-=m-M,m=M);0>p?(n-=p,p=0):p>H&&(n-=p-H,p=H);return A(t(l,n,m,p))}function w(f){0>f[0]&&(f[0]=0);0>f[1]&&(f[1]=
0);f[0]>M&&(f[0]=M);f[1]>H&&(f[1]=H);return[Math.round(f[0]),Math.round(f[1])]}function t(f,x,Q,P){var ca=f,p=Q,m=x,W=P;Q<f&&(ca=Q,p=f);P<x&&(m=P,W=x);return[ca,m,p,W]}function A(f){return{x:f[0],y:f[1],x2:f[2],y2:f[3],w:f[2]-f[0],h:f[3]-f[1]}}var l=0,n=0,y=0,v=0,aa,X;return{flipCoords:t,setPressed:function(f){f=w(f);y=l=f[0];v=n=f[1]},setCurrent:function(f){f=w(f);aa=f[0]-y;X=f[1]-v;y=f[0];v=f[1]},getOffset:function(){return[aa,X]},moveOffset:function(f){var x=f[0];f=f[1];0>l+x&&(x-=x+l);0>n+f&&
(f-=f+n);H<v+f&&(f+=H-(v+f));M<y+x&&(x+=M-(y+x));l+=x;y+=x;n+=f;v+=f},getCorner:function(f){var x=d();switch(f){case "ne":return[x.x2,x.y];case "nw":return[x.x,x.y];case "se":return[x.x2,x.y2];case "sw":return[x.x,x.y2]}},getFixed:d}}(),la=function(){function d(){return w(L.getFixed())}function w(x){f.top.css({left:F(x.x),width:F(x.w),height:F(x.y)});f.bottom.css({top:F(x.y2),left:F(x.x),width:F(x.w),height:F(H-x.y2)});f.right.css({left:F(x.x2),width:F(M-x.x2)});f.left.css({width:F(x.x)})}function t(){return e("<div />").css({position:"absolute",
backgroundColor:a.shadeColor||a.bgColor}).appendTo(X)}function A(){aa||(aa=!0,X.insertBefore(J),d(),D.setBgOpacity(1,0,1),ma.hide(),l(a.shadeColor||a.bgColor,1),D.isAwake()?y(a.bgOpacity,1):y(1,1))}function l(x,Q){z(v(),x,Q)}function n(){aa&&(X.remove(),ma.show(),aa=!1,D.isAwake()?D.setBgOpacity(a.bgOpacity,1,1):(D.setBgOpacity(1,1,1),D.disableHandles()),z(ja,0,1))}function y(x,Q){aa&&(a.bgFade&&!Q?X.animate({opacity:1-x},{queue:!1,duration:a.fadeTime}):X.css({opacity:1-x}))}function v(){return X.children()}
var aa=!1,X=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),f={top:t(),left:t().height(H),right:t().height(H),bottom:t()};return{update:d,updateRaw:w,getShades:v,setBgColor:l,enable:A,disable:n,resize:function(x,Q){f.left.css({height:F(Q)});f.right.css({height:F(Q)})},refresh:function(){a.shade?A():n();D.isAwake()&&y(a.bgOpacity)},opacity:y}}(),D=function(){function d(p,m){m=e("<div />").mousedown(O(p)).css({cursor:p+"-resize",position:"absolute",zIndex:m}).addClass("ord-"+p);fa.support&&
m.bind("touchstart.jcrop",fa.createDragger(p));qa.append(m);return m}function w(p){var m;for(m=0;m<p.length;m++)d(p[m],Q++).addClass("jcrop-dragbar")}function t(p){var m;for(m=0;m<p.length;m++){switch(p[m]){case "n":var W="hline";break;case "s":W="hline bottom";break;case "e":W="vline right";break;case "w":W="vline"}var ka=W;ka=e("<div />").css({position:"absolute",opacity:a.borderOpacity}).addClass(a.baseClass+"-"+ka);ya.append(ka)}}function A(p){var m;for(m=0;m<p.length;m++){var W=a.handleSize,
ka=d(p[m],Q++).css({opacity:a.handleOpacity}).addClass(a.baseClass+"-handle");W&&ka.width(W).height(W)}}function l(){var p=L.getFixed();L.setPressed([p.x,p.y]);L.setCurrent([p.x2,p.y2]);n()}function n(p){if(x)return y(p)}function y(p){var m=L.getFixed(),W=m.h;ra.width(Math.round(m.w)).height(Math.round(W));W=m.x;var ka=m.y;a.shade||ma.css({top:F(-ka),left:F(-W)});ra.css({top:F(ka),left:F(W)});a.shade&&la.updateRaw(m);x||(ra.show(),a.shade?la.opacity(ta):v(ta,!0),x=!0);p?a.onSelect.call(ea,ha(m)):
a.onChange.call(ea,ha(m))}function v(p,m,W){if(x||m)a.bgFade&&!W?J.animate({opacity:p},{queue:!1,duration:a.fadeTime}):J.css("opacity",p)}function aa(){P=!0;if(a.allowResize)return qa.show(),!0}function X(){P=!1;qa.hide()}function f(p){p?(Ba=!0,X()):(Ba=!1,aa())}var x,Q=370,P=!1;a.dragEdges&&e.isArray(a.createDragbars)&&w(a.createDragbars);e.isArray(a.createHandles)&&A(a.createHandles);a.drawBorders&&e.isArray(a.createBorders)&&t(a.createBorders);e(document).bind("touchstart.jcrop-ios",function(p){e(p.currentTarget).hasClass("jcrop-tracker")&&
p.stopPropagation()});var ca=h().mousedown(O("move")).css({cursor:"move",position:"absolute",zIndex:360});fa.support&&ca.bind("touchstart.jcrop",fa.createDragger("move"));ya.append(ca);X();return{updateVisible:n,update:y,release:function(){X();ra.hide();a.shade?la.opacity(1):v(1);x=!1;a.onRelease.call(ea)},refresh:l,isAwake:function(){return x},setCursor:function(p){ca.css("cursor",p)},enableHandles:aa,enableOnly:function(){P=!0},showHandles:function(){P&&qa.show()},disableHandles:X,animMode:f,setBgOpacity:v,
done:function(){f(!1);l()}}}(),ia=function(){function d(v){l(c(v));return!1}function w(v){v.preventDefault();v.stopPropagation();pa&&(pa=!1,n(c(v)),D.isAwake()&&a.onSelect.call(ea,ha(L.getFixed())),na.css({zIndex:290}),e(document).unbind(".jcrop"),l=function(){},n=function(){});return!1}function t(v){l(c(fa.cfilter(v)));return!1}function A(v){return w(fa.cfilter(v))}var l=function(){},n=function(){},y=a.trackDocument;y||na.mousemove(d).mouseup(w).mouseout(w);J.before(na);return{activateHandlers:function(v,
aa,X){pa=!0;l=v;n=aa;na.css({zIndex:450});X?e(document).bind("touchmove.jcrop",t).bind("touchend.jcrop",A):y&&e(document).bind("mousemove.jcrop",d).bind("mouseup.jcrop",w);return!1},setCursor:function(v){na.css("cursor",v)}}}(),za=function(){function d(n){A.hide()}function w(n,y,v){a.allowMove&&(L.moveOffset([y,v]),D.updateVisible(!0));n.preventDefault();n.stopPropagation()}function t(n){if(n.ctrlKey||n.metaKey)return!0;var y=(Ea=n.shiftKey?!0:!1)?10:1;switch(n.keyCode){case 37:w(n,-y,0);break;case 39:w(n,
y,0);break;case 38:w(n,0,-y);break;case 40:w(n,0,y);break;case 27:a.allowSelect&&D.release();break;case 9:return!0}return!1}var A=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),l=e("<div />").css({position:"absolute",overflow:"hidden"}).append(A);a.keySupport&&(A.keydown(t).blur(d),Da||!a.fixedSupport?(A.css({position:"absolute",left:"-20px"}),l.append(A).insertBefore(J)):A.insertBefore(J));return{watchKeys:function(){a.keySupport&&(A.show(),
A.focus())}}}();fa.support&&na.bind("touchstart.jcrop",fa.newSelection);qa.hide();G(!0);var ea={setImage:function(d,w){D.release();I();var t=new Image;t.onload=function(){var A=t.height,l=a.boxWidth,n=a.boxHeight;J.width(t.width).height(A);J.attr("src",d);ma.attr("src",d);T(J,l,n);M=J.width();H=J.height();ma.width(M).height(H);na.width(M+2*sa).height(H+2*sa);ja.width(M).height(H);la.resize(M,H);N();"function"===typeof w&&w.call(ea)};t.src=d},animateTo:function(d,w){var t=d[0]/Z,A=d[1]/ba,l=d[2]/Z,
n=d[3]/ba;if(!Ba){d=L.flipCoords(t,A,l,n);var y=L.getFixed(),v=[y.x,y.y,y.x2,y.y2],aa=a.animationDelay,X=d[0]-v[0],f=d[1]-v[1],x=d[2]-v[2],Q=d[3]-v[3],P=0,ca=a.swingSpeed;t=v[0];A=v[1];l=v[2];n=v[3];D.animMode(!0);var p=function(){return function(){P+=(100-P)/ca;v[0]=Math.round(t+P/100*X);v[1]=Math.round(A+P/100*f);v[2]=Math.round(l+P/100*x);v[3]=Math.round(n+P/100*Q);99.8<=P&&(P=100);100>P?(E(v),window.setTimeout(p,aa)):(D.done(),D.animMode(!1),"function"===typeof w&&w.call(ea))}}();window.setTimeout(p,
aa)}},setSelect:B,setOptions:function(d){u(d);G()},tellSelect:function(){return ha(L.getFixed())},tellScaled:function(){return L.getFixed()},setClass:function(d){ja.removeClass().addClass(a.baseClass+"-holder").addClass(d)},disable:I,enable:N,cancel:function(){D.done();ia.activateHandlers(null,null)},release:D.release,destroy:function(){ja.remove();V.show();V.css("visibility","visible");e(R).removeData("Jcrop")},focus:za.watchKeys,getBounds:function(){return[M*Z,H*ba]},getWidgetSize:function(){return[M,
H]},getScaleFactor:function(){return[Z,ba]},getOptions:function(){return a},ui:{holder:ja,selection:ra}};da&&ja.bind("selectstart",function(){return!1});V.data("Jcrop",ea);return ea};e.fn.Jcrop=function(R,K){var F;this.each(function(){if(e(this).data("Jcrop")){if("api"===R)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(R)}else"IMG"==this.tagName?e.Jcrop.Loader(this,function(){e(this).css({display:"block",visibility:"hidden"});F=e.Jcrop(this,R);e.isFunction(K)&&K.call(F)}):(e(this).css({display:"block",
visibility:"hidden"}),F=e.Jcrop(this,R),e.isFunction(K)&&K.call(F))});return this};e.Jcrop.Loader=function(R,K,F){function g(){u.complete?(c.unbind(".jcloader"),e.isFunction(K)&&K.call(u)):window.setTimeout(g,50)}var c=e(R),u=c[0];c.bind("load.jcloader",g).bind("error.jcloader",function(r){c.unbind(".jcloader");e.isFunction(F)&&F.call(u)});u.complete&&e.isFunction(K)&&(c.unbind(".jcloader"),K.call(u))};e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",
addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},
onRelease:function(){}}})(jQuery);
(function(e,R){var K=0;const F="png PNG jpg JPG jpeg JPEG".split(" ");e.widget("s3.imageUpload",{options:{field:"None"},_create:function(){this.id=K;K+=1;this.eventNamespace=".imageUpload"},_init:function(){const g=this.options,c=e(this.element).closest("div.image-input");this.canvas=e(".image-input-canvas",c);this.canvasSize=[0,0];this.toScale=!0;this.uploadTitle=e(".upload-title",c);this.uploadContainer=e(".upload-container",c);this.uploadedImage=e(".uploaded-image",c);this.dropArea=e(".imagecrop-drag",
c);this.captureButton=e(".capture-btn",c);this.imageCropData=e('input[name="'+g.field+'-imagecrop-data"]',c);this.selectCrop=e(".select-crop-btn",c);this.crop=e(".crop-btn",c);this.cancel=e(".remove-btn",c);this.cropPoints=this.jCropAPI=this.extension=this.fileName=this.image=null;this.refresh()},_destroy:function(){},refresh:function(){this._unbindEvents();this.image=new Image;this.fileName="upload.png";this.extension="png";this._removeCropAPI();e(this.element).closest("div.image-input");const g=
this.canvas,c=this;if(g.length){var u=g.width(),r=g.height();this.toScale=!0;if(0==u||0==r)this.toScale=!1,u=r=600;this.canvasSize=[u,r];var C=this.image,S=this.imageCropData.attr("value"),Y=this.imageCropData.data("filename");S!==R&&(C.src=S,C.onload=function(){g.attr({width:C.width,height:C.height});g[0].getContext("2d").drawImage(C,0,0,C.width,C.height);var O=S.split(".");O=O[O.length-1];"jpg"==O&&(O="jpeg");c.extension=O;c.fileName=Y?Y:"upload_"+(new Date).valueOf()+"."+O;O=g[0].toDataURL("image/"+
O);c._loadImage(O)});this._bindEvents()}},_calculateScale:function(g,c){let u;c[0]>g[0]&&(u=g[0]/c[0],c[0]*=u,c[1]*=u);c[1]>g[1]&&(u=g[1]/c[1],c[0]*=u,c[1]*=u);c[0]=Math.floor(c[0]);c[1]=Math.floor(c[1]);return c},_loadImage:function(g){const c=this;let u=this.image,r;u.src=g;u.onload=function(){let C=c._calculateScale(c.canvasSize,[u.width,u.height]),S=c.canvas[0];S.width=C[0];S.height=C[1];S.getContext("2d").drawImage(u,0,0,C[0],C[1]);r=S.toDataURL("image/"+c.extension);c.toScale?c.imageCropData.val(c.fileName+
";"+r):c.imageCropData.val(c.fileName+";"+g);c.uploadedImage.attr({src:r,style:"display: block"});c.selectCrop.css({display:"inline"});e("hr").attr({style:"display:block"})}},_initCropAPI:function(){const g=this;this._removeCropAPI();this.uploadedImage.Jcrop({onChange:function(c){g.cropPoints=[c.x,c.y,c.x2,c.y2]},opacity:.2,bgFade:!0,bgColor:"black",addClass:"jcrop-light"},function(){g.jCropAPI=this;this.ui.selection.addClass("jcrop-selection");this.disable()})},_removeCropAPI:function(){this._deactivateCrop();
const g=this.jCropAPI;g&&(g.destroy(),this.jCropAPI=null);this.cropPoints=null},_activateCrop:function(){const g=this.jCropAPI;if(g){g.enable();var c=g.getBounds(),u=c[0]/2,r=c[1]/2,C=c[0]/4;c=c[1]/4;g.animateTo([u-C,r-c,u+C,r+c]);this.selectCrop.css({display:"none"});this.crop.css({display:"inline"});this.cancel.css({display:"inline"})}},_deactivateCrop:function(){const g=this.jCropAPI;g&&(g.release(),g.disable());this.selectCrop.css({display:"inline"});this.crop.css({display:"none"});this.cancel.css({display:"none"})},
_cropImage:function(){var g=this.image,c=e(".jcrop-holder",e(this.element).closest("div.image-input")),u=parseInt(c.css("width").split("px")[0]),r=parseInt(c.css("height").split("px")[0]);c=g.width/u;r=g.height/r;if(u=this.cropPoints){var C=u[0],S=u[1],Y=u[3];u=Math.round((u[2]-C)*c);r=Math.round((Y-S)*r);this._removeCropAPI();Y=this.canvas;var O=Y[0];Y.attr({width:u,height:r});O.getContext("2d").drawImage(g,Math.round(C*c),Math.round(S*c),u,r,0,0,u,r);g=O.toDataURL("image/"+this.extension);this._loadImage(g)}},
_isValidImage:function(g){g=g.type.split("/");var c=g[g.length-1];if("image"==g[0]&&-1!=e.inArray(c,F))return"png"==c||"PNG"==c?"png":"jpeg"},_FileHoverHandler:function(g){g.stopPropagation();g.preventDefault();let c=e(g.target);c.addClass("imagecrop-drag");"dragenter"==g.type?c.addClass("hover"):c.removeClass("hover")},_FileSelectHandler:function(g){const c=e(this.element),u=this;this._removeCropAPI();"drop"==g.type&&this._FileHoverHandler(g);setTimeout(function(){u.uploadContainer.slideUp("fast",
function(){u.uploadTitle.html("<a>"+i18n.upload_new_image+"</a>")})},500);g=(g.target.files||g.originalEvent.dataTransfer.files)[0];var r=this._isValidImage(g);r?(this.fileName=g.name,this.extension=r,r=new FileReader,r.onload=function(C){u._loadImage(C.target.result)},r.readAsDataURL(g)):alert(i18n.invalid_image+"\n"+i18n.supported_image_formats+": png, jpeg or jpg");c.val("")},_openCameraDialog:function(){const g=this,c=this.eventNamespace;var u=e('<div class="capture-form">').css({overflow:"hidden",
"max-width":"100%"}),r=e("<video>").css({width:"640px",display:"block","margin-left":"auto","margin-right":"auto"}).appendTo(u),C=e('<button type="button">Capture Image</button>');C.addClass("primary button action-btn").css({display:"block",width:"100%"}).appendTo(u);var S=u.dialog({title:"Capture Image",width:640,autoOpen:!1,modal:!0,classes:{"ui-dialog":"capture-dialog"},close:function(){}});navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:["environment","user"]}},audio:!1}).then(Y=>
{r.show();S.dialog("open");let O=r.get(0);O.srcObject=Y;O.play();r.add(C).off(c).on("click"+c,function(T){T.stopPropagation();T.preventDefault();g._captureImage(O);S.dialog("close").dialog("destroy");u.remove()})}).catch(Y=>{alert(`An error occurred: ${Y}`);u.dialog("destroy");g.captureButton.prop("disabled",!0).hide()})},_captureImage:function(g){let c=document.createElement("canvas");c.width=g.videoWidth;c.height=g.videoHeight;c.getContext("2d").drawImage(g,0,0,c.width,c.height);if(g=c.toDataURL("image/png"))this.fileName=
"capture_"+(new Date).valueOf()+".png",this.extension="png",this._loadImage(g);c.remove()},_bindEvents:function(){let g=e(this.element),c=this.eventNamespace,u=this;g.on("change"+c,function(r){u._FileSelectHandler(r)});this.uploadTitle.on("click"+c,function(r){u.uploadContainer.slideDown("fast",function(){u.uploadTitle.html(i18n.upload_image)})});this.selectCrop.on("click"+c,function(){u._activateCrop()});this.crop.on("click"+c,function(){u._cropImage()});this.cancel.on("click"+c,function(){u._deactivateCrop()});
this.uploadedImage.on("load"+c,function(){u._initCropAPI()});this.dropArea.on("dragenter"+c,function(r){r.stopPropagation();r.preventDefault();u._FileHoverHandler(r)}).on("dragover"+c,function(r){r.stopPropagation();r.preventDefault()}).on("dragleave"+c,function(r){u._FileHoverHandler(r)}).on("drop"+c,function(r){r.stopPropagation();r.preventDefault();u._FileSelectHandler(r)});this.captureButton.on("click"+c,function(){u._openCameraDialog()});return this},_unbindEvents:function(){let g=e(this.element),
c=this.eventNamespace;g.off(c);this.uploadTitle.off(c);this.selectCrop.off(c);this.crop.off(c);this.cancel.off(c);this.uploadedImage.off(c);this.dropArea.off(c);this.captureButton.off(c);return this}})})(jQuery);$(function(){});
